<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Effect of a feature on predictions — FeatureEffect • iml</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Effect of a feature on predictions — FeatureEffect" />
<meta property="og:description" content="FeatureEffect computes and plots (individual) feature effects
of prediction models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">Introduction to iml: Interpretable Machine Learning in R</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel computation of interpretation methods</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/christophM/iml/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Effect of a feature on predictions</h1>
    <small class="dont-index">Source: <a href='https://github.com/christophM/iml/blob/master/R/FeatureEffect.R'><code>R/FeatureEffect.R</code></a></small>
    <div class="hidden name"><code>FeatureEffect.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>FeatureEffect</code> computes and plots (individual) feature effects
of prediction models.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The FeatureEffect class compute the effect a feature has on the prediction.
Different methods are implemented:</p><ul>
<li><p>Accumulated Local Effect (ALE) plots</p></li>
<li><p>Partial Dependence Plots (PDPs)</p></li>
<li><p>Individual Conditional Expectation (ICE) curves</p></li>
</ul>

<p>Accumulated local effects and partial dependence plots both show the average
model prediction over the feature. The difference is that ALE are computed as
accumulated differences over the conditional distribution and partial
dependence plots over the marginal distribution. ALE plots preferable to
PDPs, because they are faster and unbiased when features are correlated.</p>
<p>ALE plots for categorical features are automatically ordered by the
similarity of the categories based on the distribution of the other features
for instances in a category. When the feature is an ordered factor, the ALE
plot leaves the order as is.</p>
<p>Individual conditional expectation curves describe how, for a single
observation, the prediction changes when the feature changes and can be
combined with partial dependence plots.</p>
<p>To learn more about accumulated local effects, read the <a href='https://christophm.github.io/interpretable-ml-book/ale.html'>Interpretable Machine Learning book</a>.</p>
<p>For the partial dependence plots:
<a href='https://christophm.github.io/interpretable-ml-book/pdp.html'>https://christophm.github.io/interpretable-ml-book/pdp.html</a></p>
<p>For individual conditional expectation:
<a href='https://christophm.github.io/interpretable-ml-book/ice.html'>https://christophm.github.io/interpretable-ml-book/ice.html</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Apley, D. W. 2016. "Visualizing the Effects of Predictor Variables in Black
Box Supervised Learning Models." ArXiv Preprint.</p>
<p>Friedman, J.H. 2001. "Greedy Function Approximation: A Gradient Boosting
Machine." Annals of Statistics 29: 1189-1232.</p>
<p>Goldstein, A., Kapelner, A., Bleich, J., and Pitkin, E. (2013). Peeking
Inside the Black Box: Visualizing Statistical Learning with Plots of
Individual Conditional Expectation, 1-22.
https://doi.org/10.1080/10618600.2014.907095</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='plot.FeatureEffect.html'>plot.FeatureEffect</a></p></div>
    <h2 class="hasAnchor" id="super-class"><a class="anchor" href="#super-class"></a>Super class</h2>

    <p><code><a href='InterpretationMethod.html'>iml::InterpretationMethod</a></code> -&gt; <code>FeatureEffect</code></p>
    <h2 class="hasAnchor" id="public-fields"><a class="anchor" href="#public-fields"></a>Public fields</h2>

    <p><div class="r6-fields"></p><dl>
<dt><code>grid.size</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> | <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>)<br />
The size of the grid.</p></dd>

<dt><code>feature.name</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> | <code><a href='https://rdrr.io/r/base/character.html'>character(2)</a></code>)<br />
The names of the features for which the partial dependence was computed.</p></dd>

<dt><code>n.features</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>)<br />
The number of features (either 1 or 2).</p></dd>

<dt><code>feature.type</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> | <code><a href='https://rdrr.io/r/base/character.html'>character(2)</a></code>)<br />
The detected types of the features, either "categorical" or "numerical".</p></dd>

<dt><code>method</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>)<br /></p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="active-bindings"><a class="anchor" href="#active-bindings"></a>Active bindings</h2>

    <p><div class="r6-active-bindings"></p><dl>
<dt><code>center.at</code></dt><dd><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a><br />
Value at which the plot was centered. Ignored in the case of two
features.</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>FeatureEffect$new()</code></a></p></li>
<li><p><a href='#method-set.feature'><code>FeatureEffect$set.feature()</code></a></p></li>
<li><p><a href='#method-center'><code>FeatureEffect$center()</code></a></p></li>
<li><p><a href='#method-predict'><code>FeatureEffect$predict()</code></a></p></li>
<li><p><a href='#method-clone'><code>FeatureEffect$clone()</code></a></p></li>
</ul>
<p><details open ><summary>Inherited methods</summary>
<ul>
<li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="plot"><a href='../../iml/html/InterpretationMethod.html#method-plot'><code>iml::InterpretationMethod$plot()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="print"><a href='../../iml/html/InterpretationMethod.html#method-print'><code>iml::InterpretationMethod$print()</code></a></span></p></li>
</ul>
</details>

<hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Create a FeatureEffect object</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span>
  <span class='va'>predictor</span>,
  <span class='va'>feature</span>,
  method <span class='op'>=</span> <span class='st'>"ale"</span>,
  center.at <span class='op'>=</span> <span class='cn'>NULL</span>,
  grid.size <span class='op'>=</span> <span class='fl'>20</span>,
  grid.points <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>predictor</code></dt><dd><p><a href='Predictor.html'>Predictor</a><br />
The object (created with <code>Predictor$new()</code>) holding the machine
learning model and the data.</p></dd>

<dt><code>feature</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> | <code><a href='https://rdrr.io/r/base/character.html'>character(2)</a></code> | <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> |
<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>)<br />
The feature name or index for which to compute the effects.</p></dd>

<dt><code>method</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>)<br />
<ul>
<li><p>'ale' for accumulated local effects,</p></li>
<li><p>'pdp' for partial dependence plot,</p></li>
<li><p>'ice' for individual conditional expectation curves,</p></li>
<li><p>'pdp + ice' for partial dependence plot and ice curves within the same
plot.</p></li>
</ul></p></dd>

<dt><code>center.at</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>)<br />
Value at which the plot should be centered. Ignored in the case of two
features.</p></dd>

<dt><code>grid.size</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> | <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>)<br />
The size of the grid for evaluating the predictions.</p></dd>

<dt><code>grid.points</code></dt><dd><p>(<code>numeric() | list(numeric(), numeric())</code>)<br />
An optional grid along the feature. If grid.points are set, the grid.size
argument is ignored. Provide a list of two vectors with the same order as
in the 'feature' argument, if PDP/ALE for two features is to be computed
with a user-defined grid.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-set.feature"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>set.feature()</code></h3>
<p>Get/set feature(s) (by index) for which to compute PDP.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>set.feature</span><span class='op'>(</span><span class='va'>feature</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>feature</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>)<br />
Feature name.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-center"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>center()</code></h3>
<p>Set the value at which the ice computations are centered.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>center</span><span class='op'>(</span><span class='va'>center.at</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>center.at</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>)<br />
Value at which the plot should be centered. Ignored in the case of two
features.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-predict"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code></h3>
<p>Predict the marginal outcome given a feature.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>predict</span><span class='op'>(</span><span class='va'>data</span>, extrapolate <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>data</code></dt><dd><p><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a><br />
Data.frame with the feature or a vector.</p></dd>

<dt><code>extrapolate</code></dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>)<br />
If TRUE, predict returns NA for x values outside of observed range.
If FALSE, predcit returns the closest PDP value for x values outside the range.
Ignored for categorical features</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>Values of the effect curves at the given values.</p>
<p><hr>
<a id="method-clone"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>clone</span><span class='op'>(</span>deep <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># We train a random forest on the Boston dataset:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"Boston"</span>, package <span class='op'>=</span> <span class='st'>"MASS"</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/bethatkinson/rpart'>"rpart"</a></span><span class='op'>)</span>
<span class='va'>rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/rpart/man/rpart.html'>rpart</a></span><span class='op'>(</span><span class='va'>medv</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Boston</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='va'><a href='Predictor.html'>Predictor</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>rf</span>, data <span class='op'>=</span> <span class='va'>Boston</span><span class='op'>)</span>

<span class='co'># Compute the accumulated local effects for the first feature</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='st'>"rm"</span>, grid.size <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Again, but this time with a partial dependence plot and ice curves</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>,
  feature <span class='op'>=</span> <span class='st'>"rm"</span>, method <span class='op'>=</span> <span class='st'>"pdp+ice"</span>,
  grid.size <span class='op'>=</span> <span class='fl'>30</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>eff</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Since the result is a ggplot object, you can extend it:</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>eff</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># Adds a title</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Partial dependence"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># Adds original predictions</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>Boston</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>mod</span><span class='op'>$</span><span class='fu'>predict</span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, x <span class='op'>=</span> <span class='va'>rm</span><span class='op'>)</span>,
    color <span class='op'>=</span> <span class='st'>"pink"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span>
  <span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># If you want to do your own thing, just extract the data:</span>
<span class='va'>eff.dat</span> <span class='op'>&lt;-</span> <span class='va'>eff</span><span class='op'>$</span><span class='va'>results</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>eff.dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         rm   .value .type .id
#&gt; 1 3.561000 19.58263   pdp  NA
#&gt; 2 3.740966 19.58263   pdp  NA
#&gt; 3 3.920931 19.58263   pdp  NA
#&gt; 4 4.100897 19.58263   pdp  NA
#&gt; 5 4.280862 19.58263   pdp  NA
#&gt; 6 4.460828 19.58263   pdp  NA</div><div class='input'>
<span class='co'># You can also use the object to "predict" the marginal values.</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>predict</span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 22.30267 19.58263 27.44788</div><div class='input'><span class='co'># Instead of the entire data.frame, you can also use feature values:</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>predict</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 19.58263 19.58263 27.44788</div><div class='input'>
<span class='co'># You can reuse the pdp object for other features:</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>set.feature</span><span class='op'>(</span><span class='st'>"lstat"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>eff</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Only plotting the aggregated partial dependence:</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='st'>"crim"</span>, method <span class='op'>=</span> <span class='st'>"pdp"</span><span class='op'>)</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Only plotting the individual conditional expectation:</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='st'>"crim"</span>, method <span class='op'>=</span> <span class='st'>"ice"</span><span class='op'>)</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Accumulated local effects and partial dependence plots support up to two</span>
<span class='co'># features:</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"crim"</span>, <span class='st'>"lstat"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat
#&gt;   1: 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98
#&gt;   2: 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14
#&gt;   3: 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03
#&gt;   4: 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94
#&gt;   5: 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33
#&gt;  ---                                                                           
#&gt; 502: 0.06263  0 11.93    0 0.573 6.593 69.1 2.4786   1 273    21.0 391.99  9.67
#&gt; 503: 0.04527  0 11.93    0 0.573 6.120 76.7 2.2875   1 273    21.0 396.90  9.08
#&gt; 504: 0.06076  0 11.93    0 0.573 6.976 91.0 2.1675   1 273    21.0 396.90  5.64
#&gt; 505: 0.10959  0 11.93    0 0.573 6.794 89.3 2.3889   1 273    21.0 393.45  6.48
#&gt; 506: 0.04741  0 11.93    0 0.573 6.030 80.8 2.5050   1 273    21.0 396.90  7.88</div><div class='output co'>#&gt; <span class='message'>Loading required namespace: yaImpute</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>eff</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># FeatureEffect plots also works with multiclass classification</span>
<span class='va'>rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/rpart/man/rpart.html'>rpart</a></span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='va'><a href='Predictor.html'>Predictor</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>rf</span>, data <span class='op'>=</span> <span class='va'>iris</span>, type <span class='op'>=</span> <span class='st'>"prob"</span><span class='op'>)</span>

<span class='co'># For some models we have to specify additional arguments for the predict</span>
<span class='co'># function</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='st'>"Petal.Width"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># FeatureEffect plots support up to two features:</span>
<span class='va'>eff</span> <span class='op'>&lt;-</span> <span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sepal.Length"</span>, <span class='st'>"Petal.Length"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt;   1:          5.1         3.5          1.4         0.2
#&gt;   2:          4.9         3.0          1.4         0.2
#&gt;   3:          4.7         3.2          1.3         0.2
#&gt;   4:          4.6         3.1          1.5         0.2
#&gt;   5:          5.0         3.6          1.4         0.2
#&gt;  ---                                                  
#&gt; 146:          6.7         3.0          5.2         2.3
#&gt; 147:          6.3         2.5          5.0         1.9
#&gt; 148:          6.5         3.0          5.2         2.0
#&gt; 149:          6.2         3.4          5.4         2.3
#&gt; 150:          5.9         3.0          5.1         1.8</div><div class='input'><span class='va'>eff</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># show where the actual data lies</span>
<span class='va'>eff</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span>show.data <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-10.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># For multiclass classification models, you can choose to only show one class:</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='va'><a href='Predictor.html'>Predictor</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>rf</span>, data <span class='op'>=</span> <span class='va'>iris</span>, type <span class='op'>=</span> <span class='st'>"prob"</span>, class <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>FeatureEffect</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>mod</span>, feature <span class='op'>=</span> <span class='st'>"Sepal.Length"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='FeatureEffect-11.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christoph Molnar, <a href='https://pat-s.me'>Patrick Schratz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


